/*!
router
@version: 1.0.8
@description: Lightweight and powerful router for javascript applications
@author: Fabrizio Ruggeri <fabrizio.ruggeri@gmail.com>
@website: http://ramielcreations.com/projects/router-js/
@license GPL-2.0
*/
!function(a,b){"undefined"!=typeof module?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define(b):this[a]=b()}("Router",function(){function a(a,b){a.addEventListener?a.addEventListener("hashchange",b,!1):a.attachEvent&&a.attachEvent("hashchange",b)}function b(a,b){a.removeEventListener?a.removeEventListener("hashchange",b,!1):a.detachEvent&&a.detachEvent("hashchange",b)}function c(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[0][b]=arguments[a][b]);return arguments[0]}Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c=Array.prototype.slice.call(arguments);return a=c.shift(),function(){return b.apply(a,c.concat(Array.prototype.slice.call(arguments)))}});var d="([^/\\?]+)",e=/:([\w\d]+)/g,f=/\/\*(?!\*)/,g="/([^/\\?]+)",h=/\*{2}/,i="(.*?)\\??",j=/\/*$/,k=function(a){this.href=a,this.params={},this.query={},this.splat={},this.hasNext=!1};k.prototype.get=function(a,b){return this.params&&void 0!==this.params[a]?this.params[a]:this.query&&void 0!==this.query[a]?this.query[a]:void 0!==b?b:void 0};var l=function(b){this._options=c({ignorecase:!0},b||{}),this._routes=[],this._befores=[],this._errors={_:function(a,b,c){console&&console.warn&&console.warn("Router.js : "+c)},_404:function(a,b){console&&console.warn&&console.warn("404! Unmatched route for url "+b)},_500:function(a,b){if(!console||!console.error)throw new Error("500");console.error("500! Internal error route for url "+b)}},this._paused=!1,this._hasChangeHandler=this._onHashChange.bind(this),a(window,this._hasChangeHandler)};return l.prototype._onHashChange=function(a){return this._paused||this._route(this._extractFragment(window.location.href)),!0},l.prototype._extractFragment=function(a){var b=a.indexOf("#");return b>=0?a.substring(b):"#/"},l.prototype._throwsRouteError=function(a,b,c){return this._errors["_"+a]instanceof Function?this._errors["_"+a](b,c,a):this._errors._(b,c,a),!1},l.prototype._buildRequestObject=function(a,b,c,d){if(!a)throw new Error("Unable to compile request object");var e=new k(a);b&&(e.params=b);var f=a.split("?");if(2==f.length){var g=null,h=f[1].split("&");e.query={};for(var i=0,j=h.length;i<j;i++)g=h[i].split("="),e.query[decodeURI(g[0])]=decodeURI(g[1].replace(/\+/g,"%20"));e.query}return c&&c.length>0&&(e.splats=c),d===!0&&(e.hasNext=!0),e},l.prototype._followRoute=function(a,b,c){var d,e=c.splice(0,1),f=this._routes[e],g=b.match(f.path),h={},i=[];if(!f)return this._throwsRouteError(500,new Error("Internal error"),a);for(var j=0,k=f.paramNames.length;j<k;j++)h[f.paramNames[j]]=g[j+1];if(j+=1,g&&j<g.length)for(var l=j;l<g.length;l++)i.push(g[l]);var m=0!==c.length,n=function(b,c,d,e){return function(e,f,g){return e||f?f?this._throwsRouteError(g||500,f,a):void this._followRoute(b,c,d):this._throwsRouteError(500,'Cannot call "next" without an error if request.hasNext is false',a)}.bind(this,e)}.bind(this)(a,b,c,m);d=this._buildRequestObject(a,h,i,m),f.routeAction(d,n)},l.prototype._routeBefores=function(a,b,c,d,e){var f;if(a.length>0){var g=a.splice(0,1);g=g[0],f=function(b,f){return b?this._throwsRouteError(f||500,b,c):void this._routeBefores(a,g,c,d,e)}.bind(this)}else f=function(a,b){return a?this._throwsRouteError(b||500,a,c):void this._followRoute(c,d,e)}.bind(this);b(this._buildRequestObject(c,null,null,!0),f)},l.prototype._route=function(a){var b,c="",d=this._befores.slice(),e=[],f=a;if(0===f.length)return!0;f=f.replace(j,""),b=f.split("?")[0].replace(j,"");for(var g in this._routes)this._routes.hasOwnProperty(g)&&(c=this._routes[g],c.path.test(b)&&e.push(g));if(!(e.length>0))return this._throwsRouteError(404,null,a);if(d.length>0){var h=d.splice(0,1);h=h[0],this._routeBefores(d,h,a,f,e)}else this._followRoute(a,f,e)},l.prototype.pause=function(){return this._paused=!0,this},l.prototype.play=function(a){return a="undefined"!=typeof a&&a,this._paused=!1,a&&this._route(this._extractFragment(window.location.href)),this},l.prototype.setLocation=function(a){return window.history.pushState(null,"",a),this},l.prototype.redirect=function(a){return this.setLocation(a),this._paused||this._route(this._extractFragment(a)),this},l.prototype.addRoute=l.prototype.add=l.prototype.route=l.prototype.get=function(a,b){var c,k=this._options.ignorecase?"i":"",l=[];if("string"==typeof a){for(a=a.replace(j,"");null!==(c=e.exec(a));)l.push(c[1]);a=new RegExp(a.replace(e,d).replace(f,g).replace(h,i)+"(?:\\?.+)?$",k)}return this._routes.push({path:a,paramNames:l,routeAction:b}),this},l.prototype.before=function(a){return this._befores.push(a),this},l.prototype.errors=function(a,b){if(isNaN(a))throw new Error("Invalid code for routes error handling");if(!(b instanceof Function))throw new Error("Invalid callback for routes error handling");return a="_"+a,this._errors[a]=b,this},l.prototype.run=function(a){return a||(a=this._extractFragment(window.location.href)),a=0===a.indexOf("#")?a:"#"+a,this.redirect(a),this},l.prototype.destroy=function(){return b(window,this._hasChangeHandler),this},l});
//# sourceMappingURL=router.min.js.map